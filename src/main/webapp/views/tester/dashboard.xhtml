<?xml version='1.0' encoding='UTF-8' ?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>Tester Dashboard</title>
    <link rel="stylesheet" type="text/css" href="../../styles.css" />
</h:head>

<h:body>

    <f:metadata>
        <f:viewParam name="tester" value="#{testerController.testerName}" />
    </f:metadata>

    <h1>Tester Dashboard</h1>

    <br/><br/>

    <h:form id="form">

        <p:dataTable id="tbl"
                     value="#{testerController.assignedItems}"
                     var="it"
                     rowKey="#{it.dbId}"
                     style="width:95%;"
                     emptyMessage="Keine Testfälle zugewiesen."
                     responsiveLayout="scroll">

            <p:column headerText="TestRun ID" style="width:10rem;">
                <h:outputText value="#{it.testRun.id}" />
            </p:column>

            <p:column headerText="Tester" style="width:10rem;">
                <h:outputText value="#{it.testRun.testerName}" />
            </p:column>

            <p:column headerText="TestCase" style="width:20rem;">
                <h:outputText value="#{it.testCase.id}" /> – <h:outputText value="#{it.testCase.title}" />
            </p:column>

            <p:column headerText="Requirement" style="width:20rem;">
                <h:outputText value="#{it.testCase.requirement.id}" /> – <h:outputText value="#{it.testCase.requirement.title}" />
            </p:column>

            <p:column headerText="Ergebnis" style="width:7rem;">
                <p:selectOneMenu value="#{it.testResult}" style="width:100%;">
                    <f:selectItem itemLabel="OFFEN" itemValue="OFFEN"/>
                    <f:selectItem itemLabel="Bestanden" itemValue="PASSED"/>
                    <f:selectItem itemLabel="Fehlgeschlagen" itemValue="FAILED"/>
                </p:selectOneMenu>
            </p:column>

            <p:column headerText="Aktion" style="width:10rem;">
                <p:commandButton value="Speichern"
                                 actionListener="#{testerController.saveResult(it.dbId, it.testResult)}"
                                 process="tbl"
                                 update="tbl"
                                 styleClass="ui-button-primary" />
            </p:column>

        </p:dataTable>

        <p:messages autoUpdate="true" />

        <p:commandButton value="Zurück zur Startseite"
                         action="/index.xhtml?faces-redirect=true"
                         icon="pi pi-home"
                         styleClass="p-button-secondary"
                         style="margin:0.3rem"/>

    </h:form>

</h:body>
</html>